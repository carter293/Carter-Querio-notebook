@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  /* OKLCH Color System - adapted from design_inspo */
  :root {
    --background: oklch(0.98 0 0);
    --foreground: oklch(0.15 0 0);
    --card: oklch(1 0 0);
    --card-foreground: oklch(0.15 0 0);
    --popover: oklch(0.98 0 0);
    --popover-foreground: oklch(0.15 0 0);
    --primary: oklch(0.55 0.22 264);
    --primary-foreground: oklch(1 0 0);
    --secondary: oklch(0.96 0 0);
    --secondary-foreground: oklch(0.15 0 0);
    --muted: oklch(0.96 0 0);
    --muted-foreground: oklch(0.5 0 0);
    --accent: oklch(0.96 0 0);
    --accent-foreground: oklch(0.15 0 0);
    --destructive: oklch(0.55 0.22 25);
    --destructive-foreground: oklch(1 0 0);
    --success: oklch(0.55 0.15 145);
    --success-foreground: oklch(1 0 0);
    --warning: oklch(0.65 0.18 85);
    --warning-foreground: oklch(0.15 0 0);
    --border: oklch(0.9 0 0);
    --input: oklch(0.9 0 0);
    --ring: oklch(0.55 0.22 264);

    /* Status colors for notebook cells */
    --status-idle: oklch(0.65 0 0);
    --status-running: oklch(0.6 0.22 264);
    --status-success: oklch(0.6 0.15 145);
    --status-error: oklch(0.6 0.22 25);
    --status-blocked: oklch(0.7 0.18 85);

    /* Output backgrounds */
    --bg-output: oklch(0.96 0 0);
    --bg-error: oklch(0.95 0.05 25);
    --bg-warning: oklch(0.95 0.05 85);
    --bg-info: oklch(0.95 0.05 264);

    /* Table colors */
    --table-header: oklch(0.93 0 0);
    --table-hover: oklch(0.96 0 0);
  }

  .dark {
    --background: oklch(0.12 0 0);
    --foreground: oklch(0.95 0 0);
    --card: oklch(0.16 0 0);
    --card-foreground: oklch(0.95 0 0);
    --popover: oklch(0.16 0 0);
    --popover-foreground: oklch(0.95 0 0);
    --primary: oklch(0.6 0.22 264);
    --primary-foreground: oklch(1 0 0);
    --secondary: oklch(0.2 0 0);
    --secondary-foreground: oklch(0.95 0 0);
    --muted: oklch(0.2 0 0);
    --muted-foreground: oklch(0.65 0 0);
    --accent: oklch(0.2 0 0);
    --accent-foreground: oklch(0.95 0 0);
    --destructive: oklch(0.5 0.22 25);
    --destructive-foreground: oklch(1 0 0);
    --success: oklch(0.5 0.15 145);
    --success-foreground: oklch(1 0 0);
    --warning: oklch(0.65 0.18 85);
    --warning-foreground: oklch(0.15 0 0);
    --border: oklch(0.24 0 0);
    --input: oklch(0.24 0 0);
    --ring: oklch(0.6 0.22 264);

    /* Status colors for notebook cells - lighter in dark mode */
    --status-idle: oklch(0.5 0 0);
    --status-running: oklch(0.65 0.22 264);
    --status-success: oklch(0.65 0.15 145);
    --status-error: oklch(0.65 0.22 25);
    --status-blocked: oklch(0.7 0.18 85);

    /* Output backgrounds */
    --bg-output: oklch(0.18 0 0);
    --bg-error: oklch(0.2 0.05 25);
    --bg-warning: oklch(0.2 0.05 85);
    --bg-info: oklch(0.2 0.05 264);

    /* Table colors */
    --table-header: oklch(0.24 0 0);
    --table-hover: oklch(0.2 0 0);
  }

  /* Base element styles */
  html {
    background-color: var(--background);
  }

  body {
    background-color: var(--background);
    color: var(--foreground);
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
      'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
      sans-serif;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  code {
    font-family: source-code-pro, Menlo, Monaco, Consolas, 'Courier New',
      monospace;
  }

  /* Optimized transitions - only for color properties */
  * {
    transition-property: color, background-color, border-color,
                         text-decoration-color, fill, stroke;
    transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
    transition-duration: 200ms;
  }

  /* Optimize elements that will change during theme toggle */
  [class*="bg-"], [class*="text-"], [class*="border-"] {
    will-change: background-color, color, border-color;
  }

  /* Respect reduced motion preference */
  @media (prefers-reduced-motion: reduce) {
    * {
      transition-duration: 0ms !important;
      animation-duration: 0ms !important;
    }
  }

  /* Custom scrollbar styling */
  * {
    scrollbar-width: thin;
    scrollbar-color: var(--border) transparent;
  }

  *::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }

  *::-webkit-scrollbar-track {
    background: transparent;
  }

  *::-webkit-scrollbar-thumb {
    background-color: var(--border);
    border-radius: 4px;
  }

  *::-webkit-scrollbar-thumb:hover {
    background-color: var(--ring);
  }
}

/* Preserve existing pulse animation for status indicators */
@layer utilities {
  @keyframes pulse {
    0%, 100% {
      opacity: 1;
    }
    50% {
      opacity: 0.5;
    }
  }
}

@layer components {
  /* ============================================
     BUTTON COMPONENTS
     ============================================ */

  /* Base button styles */
  .btn {
    @apply px-4 py-2 rounded text-sm font-medium transition-colors;
    @apply focus:outline-none focus:ring-2 focus:ring-offset-2;
  }

  .btn-sm {
    @apply px-3 py-1.5 text-sm;
  }

  /* Primary action button (blue) */
  .btn-primary {
    @apply btn text-white;
    background-color: var(--primary);
  }

  .btn-primary:hover {
    background-color: oklch(from var(--primary) calc(l - 0.05) c h);
  }

  .btn-primary-sm {
    @apply btn-primary btn-sm;
  }

  /* Success/update button (green) */
  .btn-success {
    @apply btn text-white;
    background-color: var(--success);
  }

  .btn-success:hover {
    background-color: oklch(from var(--success) calc(l - 0.05) c h);
  }

  /* Danger/destructive button (red) */
  .btn-danger {
    @apply btn text-white;
    background-color: var(--destructive);
  }

  .btn-danger:hover {
    background-color: oklch(from var(--destructive) calc(l - 0.05) c h);
  }

  .btn-danger-sm {
    @apply btn-danger btn-sm;
  }

  /* Secondary/cancel button (gray) */
  .btn-secondary {
    @apply btn;
    background-color: var(--secondary);
    color: var(--secondary-foreground);
  }

  .btn-secondary:hover {
    background-color: oklch(from var(--secondary) calc(l - 0.05) c h);
  }

  /* Tertiary/outline button */
  .btn-tertiary {
    @apply btn;
    background-color: var(--accent);
    color: var(--accent-foreground);
    border: 1px solid var(--border);
  }

  .btn-tertiary:hover {
    background-color: var(--muted);
  }

  /* Icon button (for rename, etc.) */
  .btn-icon {
    @apply px-3 py-2 rounded text-sm cursor-pointer flex items-center gap-1;
    @apply transition-colors;
    background-color: var(--accent);
    color: var(--foreground);
    border: 1px solid var(--border);
  }

  .btn-icon:hover {
    background-color: var(--muted);
  }

  /* Disabled state for all buttons */
  .btn:disabled,
  .btn-primary:disabled,
  .btn-success:disabled,
  .btn-danger:disabled,
  .btn-secondary:disabled {
    @apply opacity-50 cursor-not-allowed;
  }

  /* Theme toggle button */
  .btn-theme-toggle {
    @apply px-3 py-2 rounded-lg text-sm font-medium transition-colors;
    background-color: var(--accent);
  }

  .btn-theme-toggle:hover {
    background-color: var(--muted);
  }

  /* ============================================
     CARD COMPONENTS
     ============================================ */

  /* Base card */
  .card {
    background-color: var(--card);
    border: 1px solid var(--border);
    @apply rounded-lg shadow-sm;
  }

  /* Cell card (main container) */
  .card-cell {
    @apply card p-4 mb-4;
  }

  /* Section card (DB connection, selector, etc.) */
  .card-section {
    background-color: var(--muted);
    @apply rounded-lg p-4 mb-6;
  }

  .card-section-sm {
    background-color: var(--muted);
    @apply rounded-lg p-3 mb-6;
  }

  /* Info/instructions card */
  .card-info {
    background-color: var(--bg-info);
    @apply rounded-lg p-4 text-sm;
  }

  /* ============================================
     INPUT COMPONENTS
     ============================================ */

  /* Base input field */
  .input-field {
    @apply px-3 py-2 rounded text-sm;
    background-color: var(--background);
    color: var(--foreground);
    border: 1px solid var(--border);
  }

  .input-field::placeholder {
    color: var(--muted-foreground);
  }

  .input-field:focus {
    outline: none;
    border-color: var(--ring);
    box-shadow: 0 0 0 2px var(--ring);
  }

  .input-field:disabled {
    background-color: var(--muted);
    @apply cursor-not-allowed;
  }

  /* Input with active/focus state (blue border) */
  .input-field-active {
    @apply input-field;
    border-color: var(--ring);
  }

  /* Select dropdown */
  .select-field {
    @apply input-field;
  }

  /* ============================================
     STATUS INDICATOR COMPONENTS
     ============================================ */

  /* Status dot base */
  .status-dot {
    @apply w-3 h-3 rounded-full transition-colors;
  }

  /* Status dot variants */
  .status-dot-idle {
    @apply status-dot;
    background-color: var(--status-idle);
  }

  .status-dot-running {
    @apply status-dot animate-pulse-slow;
    background-color: var(--status-running);
  }

  .status-dot-success {
    @apply status-dot;
    background-color: var(--status-success);
  }

  .status-dot-error {
    @apply status-dot;
    background-color: var(--status-error);
  }

  .status-dot-blocked {
    @apply status-dot;
    background-color: var(--status-blocked);
  }

  /* ============================================
     OUTPUT COMPONENTS
     ============================================ */

  /* Code editor container */
  .editor-container {
    @apply rounded;
    border: 1px solid var(--border);
  }

  /* Output block (stdout, generic output) */
  .output-block {
    background-color: var(--bg-output);
    @apply p-2 rounded mt-2;
  }

  /* Stdout/stderr pre block */
  .output-pre {
    @apply output-block text-xs overflow-auto whitespace-pre-wrap;
    color: var(--foreground);
  }

  /* Error output */
  .output-error {
    background-color: var(--bg-error);
    @apply p-2 rounded text-xs overflow-auto mt-2;
  }

  /* Warning/blocked output */
  .output-warning {
    background-color: var(--bg-warning);
    @apply p-2 rounded text-xs mt-2;
  }

  /* JSON output */
  .output-json {
    @apply output-pre;
  }

  /* ============================================
     TABLE COMPONENTS
     ============================================ */

  /* Table container */
  .table-container {
    @apply overflow-auto max-h-96;
  }

  /* Table base */
  .table {
    @apply min-w-full border-collapse text-sm;
    border: 1px solid var(--border);
  }

  /* Table header */
  .table-header {
    background-color: var(--table-header);
  }

  /* Table header cell */
  .table-th {
    @apply px-3 py-2 text-left font-medium;
    border: 1px solid var(--border);
    color: var(--foreground);
  }

  /* Table data cell */
  .table-td {
    @apply px-3 py-2;
    border: 1px solid var(--border);
    color: var(--foreground);
  }

  /* Table row with hover */
  .table-row-hover {
    @apply transition-colors;
  }

  .table-row-hover:hover {
    background-color: var(--table-hover);
  }

  /* ============================================
     TEXT COMPONENTS
     ============================================ */

  /* Heading/label text */
  .text-label {
    @apply text-sm font-medium;
    color: var(--foreground);
  }

  /* Block label (with margin) */
  .label {
    @apply block text-label mb-2;
  }

  /* Secondary/helper text */
  .text-helper {
    @apply text-xs;
    color: var(--muted-foreground);
  }

  /* Error text */
  .text-error {
    color: var(--destructive);
  }

  /* Null value in tables */
  .text-null {
    @apply italic;
    color: var(--muted-foreground);
  }

  /* ============================================
     LAYOUT COMPONENTS
     ============================================ */

  /* Flex row with gap */
  .flex-row-gap {
    @apply flex gap-2;
  }

  /* Flex row with items centered */
  .flex-row-center {
    @apply flex items-center gap-2;
  }

  /* Flex row with space between */
  .flex-row-between {
    @apply flex items-center justify-between;
  }

  /* Full width flex */
  .flex-full {
    @apply flex-1;
  }
}
